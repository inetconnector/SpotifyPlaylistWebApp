@using System.Globalization
@using System.Text.Json
@using Microsoft.Extensions.Localization
@using SpotifyPlaylistWebApp
@inject IStringLocalizer<SharedResource> L
@{
    Layout = "Layout";
    ViewData["Title"] = "Spotify → Plex Export";

    var data = TempData["ExportOneResult"]?.ToString();
    dynamic result = null;

    if (!string.IsNullOrEmpty(data))
    {
        result = JsonSerializer.Deserialize<dynamic>(data);
    }
}

<!DOCTYPE html>
<html lang="@CultureInfo.CurrentUICulture.Name">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <script src="https://cdn.tailwindcss.com"></script>
    <title>@ViewData["Title"]</title>
</head>

<body class="min-h-screen bg-gradient-to-b from-[#0b0f17] to-[#141a27] text-white font-sans">

<div class="max-w-xl mx-auto mt-16 p-8 bg-white/5 rounded-3xl shadow-xl backdrop-blur-sm text-center">

    <div class="flex justify-center mb-4">
        <img src="/images/plex-spotify.svg" alt="Spotify→Plex" class="h-12 w-12"/>
    </div>

    <h1 class="text-3xl font-bold mb-3">Spotify → Plex</h1>
    <p class="text-gray-300 mb-8">@L["Plex_ExportSummary"]</p>

    @if (result != null)
    {
        <div class="bg-green-700/40 border border-green-500 rounded-lg p-4 mb-6 text-left">
            <h2 class="text-xl font-semibold mb-2">✅ @result["exportedName"]</h2>
            <p class="text-gray-200">@L["Plex_ExportedTracks"]: @result["addedCount"]</p>
            <p class="text-gray-200">@L["Plex_MissingTracks"]: @result["missingCount"]</p>
        </div>
    }
    else
    {
        <div class="bg-red-600/30 border border-red-500 rounded-lg p-4 mb-6">
            ⚠️ @L["Plex_NoExportData"]
        </div>
    }

    <form method="get" action="/HomePlex/SpotifyToPlex">
        <button type="submit"
                class="w-full py-3.5 bg-gradient-to-r from-gray-700 to-gray-900
                           text-white font-semibold rounded-xl shadow-[0_4px_12px_rgba(0,0,0,0.3)]
                           hover:brightness-110 active:translate-y-[1px] transition-all duration-150">
            ⬅️ @L["Plex_BackToOverview"]
        </button>
    </form>
</div>
</body>
</html>