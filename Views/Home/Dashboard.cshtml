@using System.Globalization
@using Microsoft.Extensions.Localization
@using SpotifyPlaylistWebApp
@await Html.PartialAsync("LanguageSwitcher")
@inject IStringLocalizer<SharedResource> L
@{
    Layout = null;
    var user = ViewBag?.User as string ?? "Spotify User";
}
<!doctype html>
<html lang="@CultureInfo.CurrentUICulture.Name">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>@L["Dashboard_Dashboard_InetConnector_Playlist_Generator_nutzt"]</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background: radial-gradient(1000px 600px at 20% 10%, rgba(16,185,129,0.25), transparent 60%), radial-gradient(900px 600px at 90% 0%, rgba(99,102,241,0.25), transparent 60%), #0b0f17;
            color: white;
            font-family: system-ui, sans-serif;
        }

        .glass {
            background: rgba(255,255,255,0.08);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.12);
        }

        a {
            color: #10b981;
            text-decoration: underline;
        }

            a:hover {
                color: #34d399;
            }

        /* === Modern Spotify Buttons (mit Tooltip) === */
        .btn {
            position: relative;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.35rem;
            width: 9rem;
            height: 9rem;
            border-radius: 1.1rem;
            font-size: 1.05rem;
            font-weight: 600;
            color: white;
            text-decoration: none;
            background: linear-gradient(145deg, rgba(255,255,255,0.06), rgba(255,255,255,0.1));
            border: 1px solid rgba(255,255,255,0.15);
            backdrop-filter: blur(8px);
            box-shadow: 0 0 12px rgba(16,185,129,0.25);
            transition: all 0.25s ease;
        }

            .btn:hover {
                background: linear-gradient(145deg, rgba(16,185,129,0.28), rgba(99,102,241,0.22));
                transform: translateY(-3px) scale(1.03);
                box-shadow: 0 0 26px rgba(16,185,129,0.4);
            }

            .btn span.icon {
                font-size: 1.9rem;
                filter: drop-shadow(0 0 6px rgba(16,185,129,0.55));
            }

            /* === Tooltip Styling === */
            .btn[data-tip]::after {
                content: attr(data-tip);
                position: absolute;
                bottom: -2.6rem;
                left: 50%;
                transform: translateX(-50%) translateY(6px);
                background: rgba(0, 0, 0, 0.8);
                color: #fff;
                padding: 0.4rem 0.7rem;
                border-radius: 0.5rem;
                font-size: 0.75rem;
                white-space: nowrap;
                pointer-events: none;
                opacity: 0;
                transition: all 0.25s ease;
            }

            .btn:hover::after {
                opacity: 1;
                transform: translate(-50%, 0);
            }

        /* === Fade-in Animation (Razor-escape @@) === */
        @@keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeInUp 0.8s ease forwards;
        }

        .delay-1 {
            animation-delay: 0.2s;
        }

        .delay-2 {
            animation-delay: 0.4s;
        }

        .delay-3 {
            animation-delay: 0.6s;
        }

        /* === Share Buttons === */
        .share-btn {
            width: 2.75rem;
            height: 2.75rem;
            border-radius: 9999px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.05rem;
            text-decoration: none;
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

            .share-btn:hover {
                transform: scale(1.12);
                box-shadow: 0 0 14px rgba(255,255,255,0.15);
            }

        .wa {
            background-color: #25D366;
        }

        .tg {
            background-color: #0088cc;
        }

        .x {
            background-color: #000;
        }

        .fb {
            background-color: #1877F2;
        }

        .rd {
            background-color: #FF4500;
        }

        .li {
            background-color: #0A66C2;
        }

        .em {
            background-color: #6B7280;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col">

<main class="flex-grow max-w-4xl mx-auto px-6 py-16">
    <div class="glass rounded-3xl p-8 md:p-10 shadow-xl text-center">
        <h1 class="text-3xl md:text-4xl font-bold mb-2 fade-in">Willkommen, @user üëã</h1>
        <p class="text-white/70 mb-8 fade-in delay-1">@L["Dashboard_Erstelle_automatisch_deine_Spotify_Playlists_mit"]</p>

        <!-- Hauptaktionen (ALLE 5 Buttons, mit Tooltips & .btn-Klasse f√ºr Cooldown) -->
        <div class="flex flex-wrap justify-center gap-7 mt-6 fade-in delay-2">
            <a href="/Home/CloneLikedSongs" class="btn" data-tip="@L["Desc_Liked_Clone"]">
                <span class="icon">üìú</span>
                <span>@L["Btn_Liked_Clone"]</span>
            </a>

            <a href="/Home/CreateAlternativeFavorites" class="btn" data-tip="@L["Desc_Alternative_Favorites"]">
                <span class="icon">üé∂</span>
                <span>@L["Btn_Alternative_Favorites"]</span>
            </a>

            <a href="/Home/CreateRecommendations" class="btn" data-tip="@L["Desc_Recommendations"]">
                <span class="icon">‚ú®</span>
                <span>@L["Btn_Recommendations"]</span>
            </a>

            <a href="/Home/CreateFavMix" class="btn" data-tip="@L["Desc_Liked_Shuffle"]">
                <span class="icon">üîÄ</span>
                <span>@L["Btn_Liked_Shuffle"]</span>
            </a>

            <a href="/Home/CreateTopList" class="btn" data-tip="@L["Desc_Most_Listened"]">
                <span class="icon">üìà</span>
                <span>@L["Btn_Most_Listened"]</span>
            </a>
        </div>

        <p class="mt-10 text-white/70 text-sm">
            @L["Dashboard_Jede_Aktion_erstellt_eine_neue_Playlist_in_deine"]<br/>
            @L["Dashboard_Die_Erstellung_erfolgt_im_Hintergrund_und_dauert"]
        </p>

        <hr class="my-10 border-white/20"/>

        <!-- Spendenblock -->
        <div class="flex flex-col items-center">
            <h2 class="text-2xl font-semibold mb-3">@L["Dashboard_Unterst_tze_das_Projekt"]</h2>
            <a href="https://www.paypal.com/donate/?hosted_button_id=ZH7VMENE4XQ3G"
               target="_blank" rel="noopener"
               class="btn mb-4 text-lg px-8 py-4 w-auto h-auto">
                üíö @L["Dashboard_Jetzt_ber_PayPal_spenden"]
            </a>
            <a href="https://www.paypal.com/donate/?hosted_button_id=ZH7VMENE4XQ3G"
               target="_blank" rel="noopener"
               class="inline-block transition-transform hover:scale-105">
                <img src="/QR-Code.png" alt="@L["Attr_Dashboard_PayPal_QR_Code"]"
                     class="w-36 h-36 rounded-2xl border border-white/20 shadow-md hover:border-emerald-400 hover:shadow-emerald-400/20 transition-all"/>
            </a>
            <p class="text-white/60 text-sm mt-3">@L["Dashboard_Scanne_den_QR_Code_zum_Spenden"]</p>
        </div>

        <hr class="my-10 border-white/20"/>

        <!-- Teilen -->
        <div class="text-center">
            <h2 class="text-2xl font-semibold mb-3">@L["Dashboard_Teile_dieses_Tool"]</h2>
            <p class="text-white/70 text-sm mb-4">@L["Dashboard_Hilf_anderen_ihre_Spotify_Playlists_zu_optimiere"]</p>
            <div class="flex flex-wrap justify-center gap-3">
                <a href="https://wa.me/?text=üéß%20InetConnector%20Playlist%20Generator‚Ñ¢%20https://playlists.inetconnector.com"
                   target="_blank" class="share-btn wa" title="@L["Attr_Dashboard_WhatsApp"]">
                    WA
                </a>
                <a href="https://t.me/share/url?url=https://playlists.inetconnector.com"
                   target="_blank" class="share-btn tg" title="@L["Attr_Dashboard_Telegram"]">
                    TG
                </a>
                <a href="https://x.com/intent/tweet?text=üéß%20InetConnector%20Playlist%20Generator‚Ñ¢%20https://playlists.inetconnector.com"
                   target="_blank" class="share-btn x" title="@L["Attr_Dashboard_X_Twitter"]">
                    ùïè
                </a>
                <a href="https://www.facebook.com/sharer/sharer.php?u=https://playlists.inetconnector.com"
                   target="_blank" class="share-btn fb" title="@L["Attr_Dashboard_Facebook"]">
                    Fb
                </a>
                <a href="https://www.reddit.com/submit?url=https://playlists.inetconnector.com"
                   target="_blank" class="share-btn rd" title="@L["Attr_Dashboard_Reddit"]">
                    R
                </a>
                <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://playlists.inetconnector.com"
                   target="_blank" class="share-btn li" title="@L["Attr_Dashboard_LinkedIn"]">
                    in
                </a>
                <a href="mailto:?subject=InetConnector%20Playlist%20Generator‚Ñ¢&body=Hey,%20probier%20mal%20den%20InetConnector%20Playlist%20Generator‚Ñ¢:%20https://playlists.inetconnector.com"
                   class="share-btn em" title="@L["Attr_Dashboard_E_Mail"]">
                    ‚úâÔ∏è
                </a>
            </div>
        </div>

        <div class="mt-10 text-sm text-white/70">
            <a href="/Home/Impressum" class="hover:text-white underline">@L["Dashboard_Impressum"]</a> @L["Dashboard_Text"]
            <a href="/Home/Datenschutz" class="hover:text-white underline">@L["Dashboard_Datenschutzerkl_rung"]</a>
        </div>
    </div>
</main>

<footer class="max-w-5xl mx-auto px-6 mt-10 pb-10 text-sm text-white/70">
    <div class="glass rounded-2xl p-5 flex flex-col md:flex-row justify-between items-center gap-3">
        <div>¬© @DateTime.Now.Year InetConnector ‚Äì Alle Rechte vorbehalten</div>
        <div class="flex items-center gap-3">
            <a href="https://www.paypal.com/donate/?hosted_button_id=ZH7VMENE4XQ3G"
               target="_blank" rel="noopener" class="hover:text-white underline">
                @L["Dashboard_Spenden"]
            </a>
        </div>
    </div>
</footer>

<!-- Cooldown + Spenden-Popup Script (unver√§ndert beibehalten) -->
<script>
        document.addEventListener("DOMContentLoaded", () => {
            // === Cooldown-System ===
            const cooldownMinutes = 4;
            const buttons = document.querySelectorAll(".btn");
            buttons.forEach(btn => {
                if (!btn.href || !btn.href.includes("/Home/Create")) return;
                const key = "cooldown_" + btn.href;

                const applyCooldown = (remaining) => {
                    btn.disabled = true;
                    btn.style.opacity = "0.5";
                    const original = btn.innerHTML;
                    let secs = Math.floor(remaining);
                    const timer = setInterval(() => {
                        if (secs > 0) {
                            const m = Math.floor(secs / 60);
                            const s = (secs % 60).toString().padStart(2, "0");
                            btn.innerHTML = `‚è≥ (${m}:${s})`;
                            secs--;
                        } else {
                            clearInterval(timer);
                            btn.disabled = false;
                            btn.style.opacity = "1";
                            btn.innerHTML = original;
                            localStorage.removeItem(key);
                        }
                    }, 1000);
                };

                const last = parseInt(localStorage.getItem(key) || "0");
                const diff = (Date.now() - last) / 1000;
                if (diff < cooldownMinutes * 60)
                    applyCooldown(cooldownMinutes * 60 - diff);

                btn.addEventListener("click", e => {
                    if (btn.disabled) { e.preventDefault(); return; }
                    localStorage.setItem(key, Date.now().toString());
                    applyCooldown(cooldownMinutes * 60);
                });
            });

            // === Spenden-Popup nach 4 Aktionen ===
            const clicked = JSON.parse(localStorage.getItem("clickedButtons") || "[]");
            const totalButtons = 4;

            buttons.forEach(btn => {
                if (!btn.href || !btn.href.includes("/Home/Create")) return;
                btn.addEventListener("click", () => {
                    if (!clicked.includes(btn.href)) {
                        clicked.push(btn.href);
                        localStorage.setItem("clickedButtons", JSON.stringify(clicked));
                    }
                    if (clicked.length >= totalButtons && !localStorage.getItem("donationPromptShown")) {
                        showDonationPrompt();
                        localStorage.setItem("donationPromptShown", "true");
                    }
                });
            });

            function showDonationPrompt() {
                const overlay = document.createElement("div");
                overlay.style.position = "fixed";
                overlay.style.inset = "0";
                overlay.style.background = "rgba(0,0,0,0.7)";
                overlay.style.display = "flex";
                overlay.style.justifyContent = "center";
                overlay.style.alignItems = "center";
                overlay.style.zIndex = "10000";

                const box = document.createElement("div");
                box.className = "glass p-8 rounded-3xl text-center shadow-xl";
                box.style.maxWidth = "400px";
                box.innerHTML = `
                    <h2 class="text-2xl font-bold mb-3">@L["Dashboard_Bitte_eine_kleine_Spende"]</h2>
                    <p class="text-white/70 mb-5">@L["Dashboard_Dies_zu_realisieren_war_nicht_einfach"]<br>
                    @L["Dashboard_Wenn_dir_dieses_Tool_gef_llt_unterst_tze_mich_ge"]</p>
                    <a href="https://www.paypal.com/donate/?hosted_button_id=ZH7VMENE4XQ3G"
                       target="_blank" rel="noopener"
                       class="inline-block px-6 py-3 rounded-xl bg-emerald-500 hover:bg-emerald-600 text-white font-semibold">
                       @L["Dashboard_Jetzt_spenden"]
                    </a>
                    <div class="mt-5">
                        <button id="closePrompt" class="text-sm text-white/60 hover:text-white underline">@L["Dashboard_Sp_ter"]</button>
                    </div>
                `;
                overlay.appendChild(box);
                document.body.appendChild(overlay);
                document.getElementById("closePrompt").addEventListener("click", () => overlay.remove());
            }
        });
    </script>

</body>
</html>